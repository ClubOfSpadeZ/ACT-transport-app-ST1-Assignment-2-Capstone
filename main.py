# Author: Rory Birnie u3261233, Akhil u3261101
# Date created: 13 Apr 2023
# Date last changed: 13 Apr 2020
# This program will be the main interfaces for all other script used for making a transport App for ACT buses
# the databases to be used are as follows,
# Bus Stops XML data from https://data.gov.au/dataset/ds-act-https%3A%2F%2Fwww.data.act.gov.au%2Fapi%2Fviews%2F7vpw-vmgx/details?q=action%20bus
# Bus Routes XML data from https://data.gov.au/dataset/ds-act-https%3A%2F%2Fwww.data.act.gov.au%2Fapi%2Fviews%2Fifm8-78yv/details?q=action%20bus
# OPTIONAL NXTBUS real-time data API https://data.gov.au/dataset/ds-act-https%3A%2F%2Fwww.data.act.gov.au%2Fapi%2Fviews%2Fsmqx-37iq/details?q=action%20bus
# to display the data we will used the google maps python libray and graphs to show travel and wait times
'''
Q1: How long does it take to travel from stop 1 to stop 2
Q2: What is the fastest travel time for that route out of all options
Q3: What is shortest wait time between each bus for that route at any time in the day
Q4: What is the least amount of bus swaps requried to go from stop 1 to stop 2
Q5: Draw chosen route - done 
'''
# OPTIONAL Q6: Display Bus GPS data on google maps
# Predictive Analytics: predict the next next bus for a given route if the ideal one is missed
# OPTIONAL Predictive Analytics: calculate the probability of a Route being either late Early or on-time using the NXTBUS real-time data API
# Input: XML data of Bus stops, Routes and Position, Output: Bus travel Routes

#import busRequest
#import xml.etree.ElementTree as et
#import pandas
#import googlemaps
import draw_route

coords = "MULTILINESTRING ((149.027822 -35.343882, 149.027923 -35.343883, 149.028602 -35.343878000000004, 149.028662 -35.343878000000004, 149.02871299999998 -35.343877, 149.030118 -35.343866999999996, 149.030437 -35.343865, 149.030597 -35.343859, 149.030727 -35.343849, 149.030855 -35.343838, 149.031014 -35.343817, 149.031206 -35.343787, 149.03139299999998 -35.343749, 149.031611 -35.343696, 149.031792 -35.343641999999996, 149.03200200000003 -35.343571000000004, 149.032177 -35.343501, 149.032376 -35.343412, 149.03253999999998 -35.343329, 149.03257100000002 -35.343270000000004, 149.03258300000002 -35.343206, 149.03258200000002 -35.343140000000005, 149.03256299999998 -35.343077, 149.032432 -35.342901, 149.03241200000002 -35.342853999999996, 149.032406 -35.34281, 149.032361 -35.342754, 149.032321 -35.342696999999994, 149.032288 -35.342638, 149.03226000000004 -35.342577, 149.03223799999998 -35.342514, 149.032236 -35.342506, 149.032221 -35.342449, 149.03221200000002 -35.342385, 149.032209 -35.342319, 149.03221200000002 -35.342254, 149.032218 -35.342202, 149.032245 -35.3421, 149.032265 -35.342048999999996, 149.03229299999998 -35.341988, 149.032351 -35.341895, 149.032424 -35.341809999999995, 149.032497 -35.341741, 149.032555 -35.341696, 149.032757 -35.341558, 149.03333700000005 -35.341159000000005, 149.033716 -35.340897999999996, 149.03378600000002 -35.340842, 149.03381299999998 -35.340821000000005, 149.03387800000002 -35.340757, 149.033946 -35.340678000000004, 149.033995 -35.340606, 149.034037 -35.34053, 149.03407099999998 -35.340452, 149.034097 -35.340371000000005, 149.034113 -35.34029, 149.034122 -35.340207, 149.034099 -35.340140999999996, 149.034085 -35.340074, 149.034074 -35.339869, 149.034078 -35.33984, 149.034086 -35.339812, 149.0341 -35.339785, 149.03412 -35.33976, 149.034312 -35.339751, 149.036101 -35.339597, 149.036346 -35.339575, 149.037343 -35.339487, 149.037445 -35.339469, 149.037542 -35.339446, 149.03763700000002 -35.339414, 149.03773 -35.339375, 149.03783700000005 -35.339319, 149.03816899999998 -35.339119000000004, 149.038204 -35.339077, 149.038255 -35.339031, 149.03831 -35.33899, 149.03837 -35.338954, 149.03860500000002 -35.338819, 149.038625 -35.338842, 149.038649 -35.33887, 149.038791 -35.339040999999995, 149.039199 -35.339526, 149.039366 -35.339725, 149.039391 -35.339755, 149.039417 -35.339786, 149.039539 -35.339933, 149.040818 -35.341457, 149.040867 -35.341522999999995, 149.040919 -35.341606, 149.040956 -35.341676, 149.040995 -35.341764000000005, 149.041032 -35.341807, 149.041057 -35.341848, 149.04115900000002 -35.34209500000001, 149.04118300000002 -35.342123, 149.041216 -35.342155, 149.041254 -35.342185, 149.041287 -35.342206, 149.041322 -35.342225, 149.041368 -35.342244, 149.041417 -35.342257000000004, 149.041457 -35.342265999999995, 149.04171499999998 -35.342242, 149.04197299999998 -35.342211999999996, 149.042229 -35.342172999999995, 149.042464 -35.342132, 149.042483 -35.342129, 149.04269299999999 -35.342085, 149.04294299999998 -35.342029, 149.04499199999998 -35.341592, 149.045284 -35.341537, 149.04533899999998 -35.341528000000004, 149.045397 -35.341518, 149.045691 -35.341483000000004, 149.045879 -35.341464, 149.046029 -35.341454999999996, 149.04618100000002 -35.341449, 149.046302 -35.34145, 149.04654399999998 -35.341459, 149.046661 -35.341467, 149.046809 -35.341484, 149.046925 -35.3415, 149.04707 -35.341524, 149.047116 -35.341533000000005, 149.047149 -35.341525, 149.047193 -35.341519, 149.04726200000002 -35.341519, 149.047314 -35.341528000000004, 149.047488 -35.34157400000001, 149.047624 -35.341612, 149.04779399999998 -35.341665, 149.04796000000002 -35.341722999999995, 149.048092 -35.341772999999996, 149.04835 -35.341879999999996, 149.048508 -35.341953000000004, 149.048631 -35.342015, 149.04878100000002 -35.34209400000001, 149.048982 -35.342209000000004, 149.04906499999998 -35.342251, 149.049153 -35.3423, 149.049492 -35.342490000000005, 149.04974099999998 -35.342639, 149.05006799999998 -35.342845000000004, 149.050273 -35.34297, 149.050525 -35.343115000000004, 149.050781 -35.343253999999995, 149.051247 -35.343391, 149.051275 -35.343396000000006, 149.051342 -35.3434, 149.051398 -35.34339500000001, 149.051463 -35.343381, 149.051523 -35.343356, 149.05154900000002 -35.343325, 149.051579 -35.343299, 149.051614 -35.343276, 149.051652 -35.343257, 149.051824 -35.343047999999996, 149.05182 -35.343022, 149.05182299999998 -35.343002, 149.051854 -35.342940000000006, 149.051866 -35.3429, 149.051871 -35.342858, 149.051867 -35.342825, 149.051849 -35.342806, 149.051843 -35.342795, 149.051839 -35.342783000000004, 149.051835 -35.342760999999996, 149.051839 -35.34274, 149.051853 -35.342718, 149.051866 -35.342705, 149.051882 -35.342694, 149.051903 -35.342684999999996, 149.051921 -35.342681, 149.051941 -35.34268, 149.051954 -35.342681, 149.05201100000002 -35.342653000000006, 149.05205700000002 -35.342615, 149.052083 -35.342582, 149.052126 -35.342506, 149.05217 -35.342463, 149.052224 -35.342296999999995, 149.05248899999998 -35.342345, 149.05257 -35.342338, 149.05265 -35.342344, 149.052689 -35.342351, 149.052735 -35.342366999999996, 149.052805 -35.34239900000001, 149.05291100000002 -35.342403999999995, 149.053204 -35.342405, 149.053379 -35.342405, 149.05347 -35.342405, 149.05379 -35.342405, 149.054292 -35.342405, 149.05436600000002 -35.342407, 149.054458 -35.342415, 149.054569 -35.342432, 149.05469399999998 -35.342459999999996, 149.054799 -35.342492, 149.054899 -35.342532, 149.054996 -35.342578, 149.05508799999998 -35.34263, 149.055174 -35.342689, 149.055266 -35.342764, 149.055326 -35.342822999999996, 149.055371 -35.342871, 149.055632 -35.343193, 149.055708 -35.343272999999996, 149.05573700000002 -35.343301000000004, 149.05578799999998 -35.34335, 149.055872 -35.343424, 149.05594399999998 -35.34348, 149.056018 -35.343532, 149.05611299999998 -35.343596999999995, 149.05621399999998 -35.343655, 149.05631599999998 -35.343709999999994, 149.056442 -35.34377, 149.056595 -35.343831, 149.056752 -35.343882, 149.05691399999998 -35.343925, 149.057187 -35.343931, 149.057225 -35.343924, 149.057271 -35.34391, 149.05733899999998 -35.343879, 149.057397 -35.343835, 149.057444 -35.343785, 149.057475 -35.343727, 149.057489 -35.343604, 149.057494 -35.343507, 149.057495 -35.343317, 149.057489 -35.343221, 149.057475 -35.343102, 149.05746499999998 -35.343045000000004, 149.057454 -35.342983000000004, 149.057434 -35.342890000000004, 149.057397 -35.34275, 149.057349 -35.342612, 149.05698 -35.341679, 149.05687200000003 -35.341408, 149.056755 -35.341112, 149.05639299999999 -35.3402, 149.05635700000002 -35.340115000000004, 149.056328 -35.340056, 149.056288 -35.339984, 149.056241 -35.339914, 149.056189 -35.339847, 149.05613200000002 -35.339783000000004, 149.05607 -35.339721999999995, 149.056003 -35.339664, 149.055916 -35.3396, 149.055825 -35.33954000000001, 149.055729 -35.339488, 149.055626 -35.339442, 149.055522 -35.339402, 149.055413 -35.339369, 149.0553 -35.339343, 149.05518700000002 -35.339324000000005, 149.055111 -35.339314, 149.055018 -35.339309, 149.054778 -35.339307, 149.05469399999998 -35.339307, 149.05430800000002 -35.339307, 149.054239 -35.339327000000004, 149.054169 -35.339334, 149.054124 -35.339332, 149.05408899999998 -35.339326, 149.054021 -35.339308, 149.053516 -35.339307, 149.053078 -35.339308, 149.052391 -35.339308, 149.052276 -35.339306, 149.052216 -35.33932, 149.052162 -35.339325, 149.05211699999998 -35.33932300000001, 149.052023 -35.339313, 149.051918 -35.339296999999995, 149.05181399999998 -35.33927700000001, 149.051577 -35.339217, 149.051251 -35.339134, 149.05115200000003 -35.339108, 149.051051 -35.339082, 149.051074 -35.339022, 149.05113799999998 -35.338840000000005, 149.051183 -35.338692, 149.051266 -35.338394, 149.051309 -35.338205, 149.051511 -35.33725, 149.051557 -35.337053999999995, 149.051633 -35.336797, 149.051723 -35.336543, 149.05180900000002 -35.336333, 149.051906 -35.336127000000005, 149.05193400000002 -35.336073, 149.052043 -35.335871999999995, 149.052082 -35.335803999999996, 149.052287 -35.33549, 149.052466 -35.335231, 149.052611 -35.335026, 149.052654 -35.334965999999994, 149.05299399999998 -35.334486, 149.053033 -35.33442600000001, 149.053177 -35.334184, 149.053309 -35.333938, 149.053424 -35.333684999999996, 149.053525 -35.333428999999995, 149.053609 -35.33317, 149.05368 -35.332907, 149.053721 -35.332704, 149.05375600000002 -35.332464, 149.05378100000004 -35.332223, 149.05379299999998 -35.331982, 149.053791 -35.331707, 149.053729 -35.330354, 149.053727 -35.330287, 149.05370300000004 -35.329724, 149.053661 -35.328788, 149.05366 -35.328724, 149.05364 -35.328307, 149.053637 -35.328238, 149.053626 -35.327946999999995, 149.053584 -35.326969, 149.053553 -35.326843, 149.053442 -35.326567, 149.053428 -35.326481, 149.053428 -35.326442, 149.053437 -35.326387, 149.053472 -35.326316999999996, 149.05351299999998 -35.32625, 149.05355500000002 -35.326198, 149.053619 -35.32613, 149.053698 -35.32606400000001, 149.053989 -35.325860999999996, 149.054275 -35.325655, 149.054382 -35.325573999999996, 149.054587 -35.325406, 149.054684 -35.325319, 149.054804 -35.325207, 149.054872 -35.325138, 149.056546 -35.323365, 149.05737 -35.322517, 149.05747 -35.322423, 149.057703 -35.322218, 149.05784 -35.322109999999995, 149.057919 -35.32205, 149.058114 -35.32191, 149.05836100000002 -35.321746000000005, 149.058512 -35.321647000000006, 149.058794 -35.321482, 149.05908 -35.321331, 149.05928600000001 -35.321234999999994, 149.05956600000002 -35.321117, 149.059818 -35.321021, 149.060069 -35.320939, 149.060371 -35.320849, 149.060679 -35.320768, 149.060991 -35.320697, 149.061304 -35.320634000000005, 149.061622 -35.320583, 149.061972 -35.320518, 149.06221299999999 -35.320476, 149.062452 -35.320427, 149.06269 -35.320376, 149.062926 -35.320316999999996, 149.063232 -35.320235, 149.063447 -35.32017000000001, 149.063697 -35.320088000000005, 149.063746 -35.320071, 149.06378700000002 -35.320057, 149.063954 -35.319998999999996, 149.064124 -35.319934, 149.06425900000002 -35.319879, 149.064426 -35.319806, 149.064621 -35.319712, 149.065274 -35.319382, 149.06566300000003 -35.319183, 149.066044 -35.318976, 149.066574 -35.31869900000001, 149.067188 -35.318391999999996, 149.067738 -35.318098, 149.068104 -35.317916, 149.068627 -35.317679, 149.069066 -35.317509, 149.06950700000002 -35.317363, 149.069984 -35.317215999999995, 149.07045 -35.317101, 149.070879 -35.317014, 149.07331100000002 -35.316559000000005, 149.074958 -35.316258000000005, 149.075626 -35.3161, 149.076127 -35.315958, 149.076471 -35.315853999999995, 149.076867 -35.315723999999996, 149.077203 -35.315607, 149.077369 -35.315545, 149.077721 -35.315399, 149.07801 -35.315272, 149.078354 -35.315114, 149.07843400000004 -35.315045, 149.07852 -35.314978, 149.078697 -35.314852, 149.078874 -35.314739, 149.07906699999998 -35.31462600000001, 149.079197 -35.314554, 149.07933 -35.314485, 149.079499 -35.314402, 149.080699 -35.313844, 149.080781 -35.313805, 149.08141 -35.313508, 149.081721 -35.313363, 149.082083 -35.313209, 149.08245300000002 -35.313065, 149.08268600000002 -35.312983, 149.08275600000002 -35.312962, 149.08290900000003 -35.312914, 149.082966 -35.312896, 149.083214 -35.312826, 149.083464 -35.31276, 149.08361399999998 -35.312724, 149.08401899999998 -35.31263500000001, 149.084327 -35.312577000000005, 149.08463500000002 -35.312526, 149.084968 -35.312478999999996, 149.085138 -35.312461, 149.08543600000002 -35.312435, 149.085565 -35.312426, 149.085779 -35.312416, 149.088404 -35.312368, 149.08867800000002 -35.312368, 149.08886 -35.312373, 149.089133 -35.312387, 149.089269 -35.312397, 149.089427 -35.312431, 149.089608 -35.312478999999996, 149.089784 -35.312538, 149.089933 -35.312595, 149.090074 -35.312658, 149.090214 -35.312727, 149.090347 -35.312802000000005, 149.09048700000002 -35.312892, 149.091695 -35.313753000000005, 149.09196 -35.313925, 149.092073 -35.313995, 149.092189 -35.314058, 149.09231000000003 -35.314118, 149.092433 -35.314174, 149.092559 -35.314225, 149.09268600000001 -35.314271000000005, 149.092818 -35.314312, 149.092952 -35.314347999999995, 149.09311399999999 -35.314384999999994, 149.093251 -35.314409999999995, 149.093389 -35.31443, 149.093528 -35.314444, 149.09366799999998 -35.314454, 149.093807 -35.314458, 149.09400300000001 -35.314455, 149.09417 -35.314444, 149.09433700000002 -35.314426, 149.094502 -35.3144, 149.094718 -35.314353999999994, 149.09514199999998 -35.314246000000004, 149.095452 -35.314171, 149.095764 -35.314103, 149.09607700000004 -35.314040000000006, 149.09639199999998 -35.313981, 149.096772 -35.313917, 149.097153 -35.313860999999996, 149.097472 -35.31382, 149.097777 -35.313774, 149.10223 -35.313148999999996, 149.102533 -35.313108, 149.103069 -35.313019, 149.10351599999998 -35.312940000000005, 149.10405 -35.31284, 149.10465200000002 -35.312717, 149.105251 -35.312585, 149.10690700000004 -35.312189000000004, 149.10742300000004 -35.312067, 149.111067 -35.311196, 149.11161299999998 -35.311066, 149.112851 -35.31077200000001, 149.116734 -35.309851, 149.11858700000002 -35.309412, 149.11905900000002 -35.309294, 149.119398 -35.309208, 149.119626 -35.309141, 149.11975800000002 -35.309093, 149.119831 -35.309062, 149.119947 -35.309008, 149.120044 -35.308957, 149.12008899999998 -35.30893, 149.12018600000002 -35.308865000000004, 149.120265 -35.308801, 149.120312 -35.308757, 149.12038 -35.308685, 149.120448 -35.308597, 149.120482 -35.308545, 149.120519 -35.308478, 149.120552 -35.308408, 149.120573 -35.308353000000004, 149.120847 -35.307414, 149.12090800000001 -35.307246, 149.120994 -35.307057, 149.121055 -35.306942, 149.12112199999999 -35.30682900000001, 149.121195 -35.306718, 149.121272 -35.30661, 149.121356 -35.306504, 149.121446 -35.306401, 149.12153899999998 -35.306301, 149.12163999999999 -35.306207, 149.12174299999998 -35.306114, 149.121875 -35.306008000000006, 149.12198899999999 -35.305924, 149.122108 -35.305842999999996, 149.12223 -35.305766999999996, 149.122356 -35.305696000000005, 149.122486 -35.305628999999996, 149.122682 -35.305535, 149.122798 -35.305483, 149.12294599999998 -35.305424, 149.123189 -35.305337, 149.123344 -35.30529, 149.1235 -35.305246999999994, 149.123658 -35.305209000000005, 149.123797 -35.30518300000001, 149.123913 -35.305153000000004, 149.12406399999998 -35.305101, 149.12413700000005 -35.30507, 149.124224 -35.305027, 149.124292 -35.304990999999994, 149.124374 -35.304941, 149.124451 -35.304885999999996, 149.12451000000001 -35.304840000000006, 149.12458 -35.30478, 149.124631 -35.304728999999995, 149.12468 -35.304676, 149.124731 -35.304615000000005, 149.124788 -35.304536, 149.124824 -35.304478, 149.124891 -35.30435, 149.124922 -35.304264, 149.124973 -35.304078000000004, 149.124984 -35.303946, 149.125043 -35.30361, 149.12528899999998 -35.302074, 149.125485 -35.300876, 149.125495 -35.300808, 149.125921 -35.298208, 149.12598899999998 -35.297788, 149.126453 -35.294948, 149.12652 -35.294537, 149.126776 -35.292972999999996, 149.126993 -35.291605, 149.127253 -35.289961, 149.127346 -35.289389, 149.127449 -35.288754, 149.127529 -35.288265, 149.127648 -35.287535, 149.127873 -35.28616300000001, 149.127982 -35.285470000000004, 149.128102 -35.284729999999996, 149.128195 -35.284181, 149.128163 -35.283614, 149.128149 -35.283547999999996, 149.128131 -35.283494, 149.128102 -35.283431, 149.128064 -35.283372, 149.128026 -35.283325, 149.127992 -35.283288, 149.127917 -35.283225, 149.127851 -35.283188, 149.127771 -35.283153999999996, 149.12767000000002 -35.283127, 149.127568 -35.283115, 149.12746299999998 -35.283115, 149.12736 -35.283128999999995, 149.127298 -35.283145000000005, 149.12723799999998 -35.283165000000004, 149.12718999999998 -35.283184000000006, 149.127136 -35.283213, 149.127084 -35.283246999999996, 149.127038 -35.283284, 149.126996 -35.283325, 149.126973 -35.283353999999996, 149.126941 -35.283407000000004, 149.126914 -35.283462, 149.126892 -35.28352000000001, 149.126877 -35.283589, 149.126869 -35.283649, 149.12687 -35.283708000000004, 149.12687600000004 -35.283768, 149.126887 -35.283827, 149.12690600000002 -35.283884, 149.126926 -35.28393, 149.126956 -35.283984000000004, 149.126991 -35.284034999999996, 149.127022 -35.284075, 149.127068 -35.284121999999996, 149.12710800000002 -35.284158000000005, 149.127161 -35.284197, 149.127255 -35.284253, 149.12731800000003 -35.284284, 149.12736999999998 -35.284304, 149.127425 -35.284321000000006, 149.127681 -35.28438, 149.128542 -35.284469, 149.129579 -35.284578, 149.129668 -35.284579, 149.12975500000002 -35.284572999999995, 149.129871 -35.284553, 149.129997 -35.284514, 149.130076 -35.28448, 149.130162 -35.284433, 149.130229 -35.284385, 149.1303 -35.284321999999996, 149.130927 -35.283611, 149.13111999999998 -35.283393000000004, 149.131177 -35.283327, 149.131343 -35.28314, 149.131835 -35.282582, 149.131877 -35.28252400000001, 149.131913 -35.282462, 149.131936 -35.282408000000004, 149.131955 -35.282340999999995, 149.13196399999998 -35.282274, 149.131966 -35.282216999999996, 149.13196100000002 -35.28216, 149.13195100000002 -35.282103, 149.131933 -35.282049, 149.131904 -35.281984, 149.131516 -35.281304, 149.131382 -35.281071000000004, 149.131293 -35.280918, 149.13090400000002 -35.280233, 149.13083600000002 -35.280114000000005, 149.130807 -35.280072, 149.13075800000001 -35.28001100000001, 149.130704 -35.279956, 149.130619 -35.27989, 149.13056 -35.279854, 149.130473 -35.279812, 149.13039300000003 -35.279782, 149.130417 -35.279731, 149.13043000000002 -35.279697, 149.130453 -35.279610999999996, 149.13062299999999 -35.27856, 149.130055 -35.278489, 149.12971100000001 -35.278447, 149.1296 -35.278433, 149.12947 -35.278423, 149.12934199999998 -35.278411000000006, 149.129245 -35.278405, 149.129154 -35.278401, 149.129027 -35.278387, 149.128457 -35.278325, 149.12788899999998 -35.278263, 149.127852 -35.278259000000006, 149.127811 -35.278255, 149.127049 -35.278172))"

draw_route.main(coords, "red", 2, 50, 4)

key = 'AIzaSyAzmIkaPnXXghoAImiCqL1wlYW5shytqKE'


gmaps = googlemaps.Client(key=key)


xml = busRequest.ptRequest(line=4, direction='B', start='12:30pm', end='12:40pm')
# print(xml)

# parse the XML data
tree = et.ElementTree(et.fromstring(xml.decode()))
root = tree.getroot()

# print(et.tostring(root, encoding='unicode', method='xml'))
# create an empty list to store the data
data = []

# loop through each DatedCall element and extract the required information
for dated_call in root.findall('.//{http://www.siri.org.uk/siri}DatedCall'):
    stop_point_ref = dated_call.find('{http://www.siri.org.uk/siri}StopPointRef').text
    stop_point_name = dated_call.find('{http://www.siri.org.uk/siri}StopPointName').text
    try:
        aimed_arrival_time = dated_call.find('{http://www.siri.org.uk/siri}AimedArrivalTime').text
    except AttributeError:
        aimed_arrival_time = None
    try:
        aimed_departure_time = dated_call.find('{http://www.siri.org.uk/siri}AimedDepartureTime').text
    except AttributeError:
        aimed_arrival_time = None
    data.append([stop_point_ref, stop_point_name, aimed_arrival_time, aimed_departure_time])

# create a Pandas DataFrame with the data and column names
df = pandas.DataFrame(data, columns=['StopPointRef', 'StopPointName', 'AimedArrivalTime', 'AimedDepartureTime'])

print(df.to_string(index=True))
